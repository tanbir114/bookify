 <%- include('../includes/head.ejs') %>
    <link rel="stylesheet" href="/css/product.css">
    </head>

    <body>
        <%- include('../includes/navigation.ejs') %>
        <div class="filter">

            <form action="/search" method="GET" class="search">
               
                <input type="text" id="search" name="q" placeholder="Search products">
                <button type="submit">Search</button>
            </form>
            
             
            <form action="/search" method="GET" class="sort">
                <label for="filterSort">Sort By:</label>
                <select id="filterSort" name="filterSort" onchange="this.form.submit()">
                  <!-- <option value="default" <% if (searchSort === 'default') { %>selected<% } %>>A-Z</option> -->
                   <option value="az" <% if (searchSort === 'az') { %>selected<% } %>>A-Z</option> 
                  <option value="za" <% if (searchSort === 'za') { %>selected<% } %>>Z-A</option>
                  <option value="price-asc" <% if (searchSort === 'price-asc') { %>selected<% } %>>Price Ascending</option>
                  <option value="price-desc" <% if (searchSort === 'price-desc') { %>selected<% } %>>Price Descending</option>
                </select>
    
                
    
                 <!-- Add a hidden input to store the current page -->
                <input type="hidden" name="q" value="<%= searchTerm %>">
                <input type="hidden" name="page" value="<%= currentPage %>">
                 

                
                
            </form>
            </div>

         
        

            <h1>Search Results</h1>
            <main>


                <% if (prods.length> 0) { %>
                    <% for (let product of prods) { %>
                        <div class="grid">
                            <article class="card product-item">
                                <header class="card__header">
                                    <h1 class="product__title">
                                        <%= product.title %>
                                    </h1>
                                </header>
                                <div class="card__image">
                                    <img src="<%= product.imageUrl %>" alt="<%= product.title %>">
                                </div>
                                <div class="card__content">
                                    <h2 class="product__price">$<%= product.price %>
                                    </h2>
                                    <p class="product__description">
                                        <%= product.description %>
                                    </p>
                                </div>
                                <div class="card__actions">
                                    <a href="/products/<%= product.id %>" class="btn">Details</a>
                                    <% if (req.user) { %>
                                        <%- include('../includes/add-to-cart.ejs', { product: product }) %>
                                            <% } %>
                                </div>
                            </article>
                        </div>
                        <% } %>

                            <section class="pagination">
                                <% if (currentPage != 1 && previousPage != 1) { %>
                                    <a href="?q=<%= searchTerm%>&page=1">1</a>
                                <% }%>
                                <% if (hasPrevPage) { %>
                                    <a href="?q=<%= searchTerm%>&page=<%=previousPage%>"><%=previousPage%></a>
                                <% }%>
                                <a href="?q=<%= searchTerm%>&page=<%=currentPage%>" class="active"><%=currentPage %></a>
                                <% if (hasNextPage) { %>
                                    <a href="?q=<%= searchTerm%>&page=<%=nextPage%>"><%=nextPage %></a>
                                <% }%>
                                <% if (lastPage !== currentPage && nextPage !== lastPage) { %>
                                    <a href="?q=<%= searchTerm%>&page=<%=lastPage%>"><%=lastPage %></a>
                                <% }%>
                            </section>


                            <% } else { %>
                                <h1>No Products Found!</h1>
                                <% } %>



            </main>

            <%- include('../includes/end.ejs') %>
    </body>